{"version":3,"sources":["authMiddleware.js"],"names":["jwt","require","module","exports","req","res","next","authHeader","headers","authorization","startsWith","status","json","message","token","split","decoded","verify","process","env","JWT_SECRET","user","err"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAMC,UAAU,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAA/B;;AAEA,MAAI,CAACF,UAAD,IAAe,CAACA,UAAU,CAACG,UAAX,CAAsB,SAAtB,CAApB,EAAsD;AACpD,WAAOL,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;;AAED,MAAMC,KAAK,GAAGP,UAAU,CAACQ,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CAAd;;AAEA,MAAI;AACF,QAAMC,OAAO,GAAGhB,GAAG,CAACiB,MAAJ,CAAWH,KAAX,EAAkBI,OAAO,CAACC,GAAR,CAAYC,UAA9B,CAAhB;AACAhB,IAAAA,GAAG,CAACiB,IAAJ,GAAWL,OAAX,CAFE,CAEkB;;AACpBV,IAAAA,IAAI;AACL,GAJD,CAIE,OAAOgB,GAAP,EAAY;AACZ,WAAOjB,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB,CAAP;AACD;AACF,CAhBD","sourcesContent":["const jwt = require('jsonwebtoken');\r\n\r\nmodule.exports = (req, res, next) => {\r\n  const authHeader = req.headers.authorization;\r\n\r\n  if (!authHeader || !authHeader.startsWith('Bearer ')) {\r\n    return res.status(401).json({ message: 'No token provided' });\r\n  }\r\n\r\n  const token = authHeader.split(' ')[1];\r\n\r\n  try {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    req.user = decoded; // { id, role }\r\n    next();\r\n  } catch (err) {\r\n    return res.status(401).json({ message: 'Invalid token' });\r\n  }\r\n};\r\n"],"file":"authMiddleware.dev.js"}